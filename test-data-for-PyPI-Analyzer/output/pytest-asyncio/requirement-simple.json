{
  "name": "pytest-asyncio",
  "description": "pytest-asyncio: pytest support for asyncio\n==========================================\n\n.. image:: https://img.shields.io/pypi/v/pytest-asyncio.svg\n    :target: https://pypi.python.org/pypi/pytest-asyncio\n.. image:: https://travis-ci.org/pytest-dev/pytest-asyncio.svg?branch=master\n    :target: https://travis-ci.org/pytest-dev/pytest-asyncio\n.. image:: https://codecov.io/gh/pytest-dev/pytest-asyncio/branch/master/graph/badge.svg\n        :target: https://codecov.io/gh/pytest-dev/pytest-asyncio\n.. image:: https://img.shields.io/pypi/pyversions/pytest-asyncio.svg\n    :target: https://github.com/pytest-dev/pytest-asyncio\n    :alt: Supported Python versions\n.. image:: https://img.shields.io/badge/code%20style-black-000000.svg\n    :target: https://github.com/ambv/black\n\npytest-asyncio is an Apache2 licensed library, written in Python, for testing\nasyncio code with pytest.\n\nasyncio code is usually written in the form of coroutines, which makes it\nslightly more difficult to test using normal testing tools. pytest-asyncio\nprovides useful fixtures and markers to make testing easier.\n\n.. code-block:: python\n\n    @pytest.mark.asyncio\n    async def test_some_asyncio_code():\n        res = await library.do_something()\n        assert b'expected result' == res\n\npytest-asyncio has been strongly influenced by pytest-tornado_.\n\n.. _pytest-tornado: https://github.com/eugeniy/pytest-tornado\n\nFeatures\n--------\n\n- fixtures for creating and injecting versions of the asyncio event loop\n- fixtures for injecting unused tcp ports\n- pytest markers for treating tests as asyncio coroutines\n- easy testing with non-default event loops\n- support for `async def` fixtures and async generator fixtures\n\nInstallation\n------------\n\nTo install pytest-asyncio, simply:\n\n.. code-block:: bash\n\n    $ pip install pytest-asyncio\n\nThis is enough for pytest to pick up pytest-asyncio.\n\nFixtures\n--------\n\n``event_loop``\n~~~~~~~~~~~~~~\nCreates and injects a new instance of the default asyncio event loop. By\ndefault, the loop will be closed at the end of the test (i.e. the default\nfixture scope is ``function``).\n\nNote that just using the ``event_loop`` fixture won't make your test function\na coroutine. You'll need to interact with the event loop directly, using methods\nlike ``event_loop.run_until_complete``. See the ``pytest.mark.asyncio`` marker\nfor treating test functions like coroutines.\n\nSimply using this fixture will not set the generated event loop as the\ndefault asyncio event loop, or change the asyncio event loop policy in any way.\nUse ``pytest.mark.asyncio`` for this purpose.\n\n.. code-block:: python\n\n    def test_http_client(event_loop):\n        url = 'http://httpbin.org/get'\n        resp = event_loop.run_until_complete(http_client(url))\n        assert b'HTTP/1.1 200 OK' in resp\n\nThis fixture can be easily overridden in any of the standard pytest locations\n(e.g. directly in the test file, or in ``conftest.py``) to use a non-default\nevent loop. This will take effect even if you're using the\n``pytest.mark.asyncio`` marker and not the ``event_loop`` fixture directly.\n\n.. code-block:: python\n\n    @pytest.fixture\n    def event_loop():\n        loop = MyCustomLoop()\n        yield loop\n        loop.close()\n\nIf the ``pytest.mark.asyncio`` marker is applied, a pytest hook will\nensure the produced loop is set as the default global loop.\nFixtures depending on the ``event_loop`` fixture can expect the policy to be properly modified when they run.\n\n``unused_tcp_port``\n~~~~~~~~~~~~~~~~~~~\nFinds and yields a single unused TCP port on the localhost interface. Useful for\nbinding temporary test servers.\n\n``unused_tcp_port_factory``\n~~~~~~~~~~~~~~~~~~~~~~~~~~~\nA callable which returns a different unused TCP port each invocation. Useful\nwhen several unused TCP ports are required in a test.\n\n.. code-block:: python\n\n    def a_test(unused_tcp_port_factory):\n        port1, port2 = unused_tcp_port_factory(), unused_tcp_port_factory()\n        ...\n\nAsync fixtures\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nAsynchronous fixtures are defined just like ordinary pytest fixtures, except they should be coroutines or asynchronous generators.\n\n.. code-block:: python3\n\n    @pytest.fixture\n    async def async_gen_fixture():\n        await asyncio.sleep(0.1)\n        yield 'a value'\n\n    @pytest.fixture(scope='module')\n    async def async_fixture():\n        return await asyncio.sleep(0.1)\n\nAll scopes are supported, but if you use a non-function scope you will need\nto redefine the ``event_loop`` fixture to have the same or broader scope.\nAsync fixtures need the event loop, and so must have the same or narrower scope\nthan the ``event_loop`` fixture.\n\n\nMarkers\n-------\n\n``pytest.mark.asyncio``\n~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\nMark your test coroutine with this marker and pytest will execute it as an\nasyncio task using the event loop provided by the ``event_loop`` fixture. See\nthe introductory section for an example.\n\nThe event loop used can be overriden by overriding the ``event_loop`` fixture\n(see above).\n\nIn order to make your test code a little more concise, the pytest |pytestmark|_\nfeature can be used to mark entire modules or classes with this marker.\nOnly test coroutines will be affected (by default, coroutines prefixed by\n``test_``), so, for example, fixtures are safe to define.\n\n.. code-block:: python\n\n    import asyncio\n    import pytest\n\n    # All test coroutines will be treated as marked.\n    pytestmark = pytest.mark.asyncio\n\n    async def test_example(event_loop):\n        \"\"\"No marker!\"\"\"\n        await asyncio.sleep(0, loop=event_loop)\n\n.. |pytestmark| replace:: ``pytestmark``\n.. _pytestmark: http://doc.pytest.org/en/latest/example/markers.html#marking-whole-classes-or-modules\n\nChangelog\n---------\n0.15.1 (2021-04-22)\n~~~~~~~~~~~~~~~~~~~\n- Hotfix for errors while closing event loops while replacing them.\n  `#209 <https://github.com/pytest-dev/pytest-asyncio/issues/209>`_\n  `#210 <https://github.com/pytest-dev/pytest-asyncio/issues/210>`_\n\n0.15.0 (2021-04-19)\n~~~~~~~~~~~~~~~~~~~\n- Add support for Python 3.9\n- Abandon support for Python 3.5. If you still require support for Python 3.5, please use pytest-asyncio v0.14 or earlier.\n- Set ``unused_tcp_port_factory`` fixture scope to 'session'.\n  `#163 <https://github.com/pytest-dev/pytest-asyncio/pull/163>`_\n- Properly close event loops when replacing them.\n  `#208 <https://github.com/pytest-dev/pytest-asyncio/issues/208>`_\n\n0.14.0 (2020-06-24)\n~~~~~~~~~~~~~~~~~~~\n- Fix `#162 <https://github.com/pytest-dev/pytest-asyncio/issues/162>`_, and ``event_loop`` fixture behavior now is coherent on all scopes.\n  `#164 <https://github.com/pytest-dev/pytest-asyncio/pull/164>`_\n\n0.12.0 (2020-05-04)\n~~~~~~~~~~~~~~~~~~~\n- Run the event loop fixture as soon as possible. This helps with fixtures that have an implicit dependency on the event loop.\n  `#156 <https://github.com/pytest-dev/pytest-asyncio/pull/156>`_\n\n0.11.0 (2020-04-20)\n~~~~~~~~~~~~~~~~~~~\n- Test on 3.8, drop 3.3 and 3.4. Stick to 0.10 for these versions.\n  `#152 <https://github.com/pytest-dev/pytest-asyncio/pull/152>`_\n- Use the new Pytest 5.4.0 Function API. We therefore depend on pytest >= 5.4.0.\n  `#142 <https://github.com/pytest-dev/pytest-asyncio/pull/142>`_\n- Better ``pytest.skip`` support.\n  `#126 <https://github.com/pytest-dev/pytest-asyncio/pull/126>`_\n\n0.10.0 (2019-01-08)\n~~~~~~~~~~~~~~~~~~~~\n- ``pytest-asyncio`` integrates with `Hypothesis <https://hypothesis.readthedocs.io>`_\n  to support ``@given`` on async test functions using ``asyncio``.\n  `#102 <https://github.com/pytest-dev/pytest-asyncio/pull/102>`_\n- Pytest 4.1 support.\n  `#105 <https://github.com/pytest-dev/pytest-asyncio/pull/105>`_\n\n0.9.0 (2018-07-28)\n~~~~~~~~~~~~~~~~~~\n- Python 3.7 support.\n- Remove ``event_loop_process_pool`` fixture and\n  ``pytest.mark.asyncio_process_pool`` marker (see\n  https://bugs.python.org/issue34075 for deprecation and removal details)\n\n0.8.0 (2017-09-23)\n~~~~~~~~~~~~~~~~~~\n- Improve integration with other packages (like aiohttp) with more careful event loop handling.\n  `#64 <https://github.com/pytest-dev/pytest-asyncio/pull/64>`_\n\n0.7.0 (2017-09-08)\n~~~~~~~~~~~~~~~~~~\n- Python versions pre-3.6 can use the async_generator library for async fixtures.\n  `#62 <https://github.com/pytest-dev/pytest-asyncio/pull/62>`\n\n\n0.6.0 (2017-05-28)\n~~~~~~~~~~~~~~~~~~\n- Support for Python versions pre-3.5 has been dropped.\n- ``pytestmark`` now works on both module and class level.\n- The ``forbid_global_loop`` parameter has been removed.\n- Support for async and async gen fixtures has been added.\n  `#45 <https://github.com/pytest-dev/pytest-asyncio/pull/45>`_\n- The deprecation warning regarding ``asyncio.async()`` has been fixed.\n  `#51 <https://github.com/pytest-dev/pytest-asyncio/pull/51>`_\n\n0.5.0 (2016-09-07)\n~~~~~~~~~~~~~~~~~~\n- Introduced a changelog.\n  `#31 <https://github.com/pytest-dev/pytest-asyncio/issues/31>`_\n- The ``event_loop`` fixture is again responsible for closing itself.\n  This makes the fixture slightly harder to correctly override, but enables\n  other fixtures to depend on it correctly.\n  `#30 <https://github.com/pytest-dev/pytest-asyncio/issues/30>`_\n- Deal with the event loop policy by wrapping a special pytest hook,\n  ``pytest_fixture_setup``. This allows setting the policy before fixtures\n  dependent on the ``event_loop`` fixture run, thus allowing them to take\n  advantage of the ``forbid_global_loop`` parameter. As a consequence of this,\n  we now depend on pytest 3.0.\n  `#29 <https://github.com/pytest-dev/pytest-asyncio/issues/29>`_\n\n\n0.4.1 (2016-06-01)\n~~~~~~~~~~~~~~~~~~\n- Fix a bug preventing the propagation of exceptions from the plugin.\n  `#25 <https://github.com/pytest-dev/pytest-asyncio/issues/25>`_\n\n0.4.0 (2016-05-30)\n~~~~~~~~~~~~~~~~~~\n- Make ``event_loop`` fixtures simpler to override by closing them in the\n  plugin, instead of directly in the fixture.\n  `#21 <https://github.com/pytest-dev/pytest-asyncio/pull/21>`_\n- Introduce the ``forbid_global_loop`` parameter.\n  `#21 <https://github.com/pytest-dev/pytest-asyncio/pull/21>`_\n\n0.3.0 (2015-12-19)\n~~~~~~~~~~~~~~~~~~\n- Support for Python 3.5 ``async``/``await`` syntax.\n  `#17 <https://github.com/pytest-dev/pytest-asyncio/pull/17>`_\n\n0.2.0 (2015-08-01)\n~~~~~~~~~~~~~~~~~~\n- ``unused_tcp_port_factory`` fixture.\n  `#10 <https://github.com/pytest-dev/pytest-asyncio/issues/10>`_\n\n\n0.1.1 (2015-04-23)\n~~~~~~~~~~~~~~~~~~\nInitial release.\n\n\nContributing\n------------\nContributions are very welcome. Tests can be run with ``tox``, please ensure\nthe coverage at least stays the same before you submit a pull request.\n\n\n",
  "requires_dist": [
    "pytest (>=5.4.0)",
    "coverage ; extra == 'testing'",
    "hypothesis (>=5.7.1) ; extra == 'testing'"
  ],
  "requires_python": ">= 3.6",
  "current_version": "0.15.1",
  "released_versions": [
    "0.1",
    "0.1.1",
    "0.1.2",
    "0.1.3",
    "0.10.0",
    "0.10.0.dev0",
    "0.11.0",
    "0.12.0",
    "0.14.0",
    "0.15.0",
    "0.15.1",
    "0.2.0",
    "0.3.0",
    "0.4.1",
    "0.5.0",
    "0.6.0",
    "0.7.0",
    "0.8.0",
    "0.9.0"
  ]
}